<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Video Preview Sample</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<!-- 414 x 736-->
		<div id="video-preview-container" style="width: 276px; height: 491px;"></div>
		<div id="layout-buttons-container" style="display: inline-flex;">

			<!-- <fieldset>
				<legend>Preview Size</legend>
				w: <input type="number" id="width" min="276" max="768" value="276"><br>
				h: <input type="number" id="height" min="491" max="1366" value="491">
			</fieldset> -->

			<fieldset>
				<legend>Image Position</legend>
				x: <input type="range" min="-100" max="100" value="0" id="position-x" oninput="updatePosition()"><br>
				y: <input type="range" min="-100" max="100" value="0" id="position-y" oninput="updatePosition()"><br>
				z: <input type="range" min="0" max="100" value="51" id="position-z" oninput="updateZ(this)"><br>
				<button style="padding: 4px; margin-top: 10px; margin-left: 0px;" onclick="resetPosition()">Reset to Center</button>
			</fieldset>

			<fieldset>
				<legend>Alignment</legend>
				<div><input type="checkbox" name="align" id="Top" onchange="updateAlignment()"><label for="top"> Top</label></div>
				<div><input type="checkbox" name="align" id="Bottom" onchange="updateAlignment()"><label for="bottom"> Bottom</label></div>
				<div><input type="checkbox" name="align" id="Left" onchange="updateAlignment()"><label for="left"> Left</label></div>
				<div><input type="checkbox" name="align" id="Right" onchange="updateAlignment()"><label for="right"> Right</label></div>
			</fieldset>

			<fieldset>
				<legend>Fixed axis</legend>
				<div><input type="checkbox" name="align" id="Width" onchange="updateAlignment()" checked><label for="Width"> Width</label></div>
				<div><input type="checkbox" name="align" id="Height" onchange="updateAlignment()" checked><label for="Height"> Height</label></div>
			</fieldset>
		</div>

        <script src="./dist/index.js"></script>
        <script>

			// Initialize component.
			let container = document.getElementById("video-preview-container");
			let preview = new VideoPreview.Component(container);

			// Initialize scene.
			let scene = createFaceTrackingScene("girl")
			preview.setCurrentScene(scene)

			// Apply background image.
			let background = new VideoPreview.ImageScreenComponent("/static/image/background-wall.jpg")
			background.zOrder = 0
			background.updateConstraints([VideoPreview.Constraint.Top, VideoPreview.Constraint.Bottom, VideoPreview.Constraint.Width])
			scene.addScreenComponent(background)

			// Create image for manipulation.
			let image = new VideoPreview.ImageScreenComponent("/static/image/tv-table.jpg")
			image.zOrder = 51
			scene.addScreenComponent(image)


			function createFaceTrackingScene(key) {
				let sceneData = new VideoPreview.SceneData()
				sceneData.videoPath = "/static/" + key + "/face-static.mp4"
				return new VideoPreview.FaceTrackingScene(sceneData)
			}

			function updateAlignment() {

				let constraints = []

				let elements = document.getElementsByName("align")
				for (var i = 0; i < elements.length; i++) {
					let element = elements[i]
					if (element.checked) {
						constraints.push(VideoPreview.Constraint[element.id])
					}
				}

				image.updateConstraints(constraints)
			}

			function updatePosition() {

				let x = document.getElementById("position-x").value
				let y = document.getElementById("position-y").value

				var pos = image.position
				pos.x = x / 100.0
				pos.y = y / 100.0
				image.position = pos
			}

			function resetPosition() {
				document.getElementById("position-x").value = 0
				document.getElementById("position-y").value = 0
				updatePosition()
			}

			function updateZ(element) {
				image.zOrder = element.value
			}

		</script>
	</body>
</html>
